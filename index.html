<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EC Çiftlik Rapor Sistemi</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    body {
      background: linear-gradient(135deg, #fff0f0, #ffffff);
      min-height: 100vh;
      font-family: 'Arial', sans-serif;
    }
    .navbar {
      background-color: #ff3333;
      padding: 1rem;
      border-bottom: 2px solid #cc0000;
    }
    .navbar-brand {
      color: #ffffff;
      font-weight: bold;
      font-size: 1.5rem;
    }
    .card {
      border: none;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      background: #ffffff;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .card:hover {
      transform: translateY(-10px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);
    }
    .btn-primary {
      background-color: #ff3333;
      border: none;
      transition: background-color 0.3s ease;
    }
    .btn-primary:hover {
      background-color: #cc0000;
    }
    .btn-warning {
      background-color: #ff8533;
      border: none;
      transition: background-color 0.3s ease;
    }
    .btn-warning:hover {
      background-color: #ff6600;
    }
    .btn-danger {
      background-color: #ff4d4d;
      border: none;
      transition: background-color 0.3s ease;
    }
    .btn-danger:hover {
      background-color: #ff1a1a;
    }
    .btn-info {
      background-color: #17a2b8;
      border: none;
      transition: background-color 0.3s ease;
    }
    .btn-info:hover {
      background-color: #138496;
    }
    .form-control {
      border-radius: 10px;
      border-color: #ff6666;
      transition: border-color 0.3s ease;
    }
    .form-control:focus {
      border-color: #cc0000;
      box-shadow: 0 0 5px rgba(255, 51, 51, 0.5);
    }
    h1 {
      color: #ff3333;
      font-weight: bold;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      margin-bottom: 2rem;
    }
    h3 {
      color: #cc0000;
      font-weight: 600;
    }
    #dashboard-content .card {
      margin-bottom: 25px;
    }
    .table {
      background-color: #fff;
      border-radius: 10px;
      overflow: hidden;
    }
    .table th, .table td {
      vertical-align: middle;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    #dashboard, #login-form {
      animation: fadeIn 0.5s ease-in;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    .nav-tabs .nav-link {
      color: #cc0000;
    }
    .nav-tabs .nav-link.active {
      background-color: #ff3333;
      color: #ffffff;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg">
    <div class="container">
      <a class="navbar-brand" href="#"><i class="fas fa-leaf"></i> EC Çiftlik Rapor</a>
    </div>
  </nav>
  <div class="container mt-4">
    <h1 class="text-center"><i class="fas fa-tractor"></i> EC Hayvancılık Günlük Rapor Sistemi</h1>
    <div id="login-form" class="card p-4 mx-auto" style="max-width: 400px;">
      <h2 class="text-center mb-4">Giriş Yap</h2>
      <div class="mb-3">
        <input type="text" id="username" class="form-control mb-2" placeholder="Kullanıcı Adı">
      </div>
      <div class="mb-3">
        <input type="password" id="password" class="form-control mb-2" placeholder="Şifre">
      </div>
      <button onclick="login()" class="btn btn-primary w-100 py-2"><i class="fas fa-sign-in-alt"></i> Giriş</button>
    </div>
    <div id="dashboard" style="display:none;" class="mt-4">
      <ul class="nav nav-tabs" id="dashboardTabs">
        <li class="nav-item">
          <a class="nav-link active" href="#" onclick="switchTab('current')">Güncel Rapor</a>
        </li>
        <li class="nav-item" id="historyTab" style="display:none;">
          <a class="nav-link" href="#" onclick="switchTab('history')">Geçmiş Raporlar</a>
        </li>
      </ul>
      <div class="tab-content mt-3">
        <div id="currentTab" class="tab-content active">
          <div id="dashboard-content"></div>
        </div>
        <div id="historyTabContent" class="tab-content">
          <div id="history-content"></div>
        </div>
      </div>
      <div id="change-credentials" style="display:none;" class="card p-4 mx-auto" style="max-width: 400px;">
        <h3 class="mb-3">Şifreyi Değiştir</h3>
        <div id="user-select" style="display:none;" class="mb-3">
          <label for="target-user" class="form-label">Kullanıcı Seç:</label>
          <select id="target-user" class="form-control"></select>
        </div>
        <div class="mb-3">
          <input type="password" id="new-password" class="form-control mb-2" placeholder="Yeni Şifre">
        </div>
        <button onclick="changeCredentials()" class="btn btn-warning w-100 py-2"><i class="fas fa-key"></i> Değiştir</button>
      </div>
      <button onclick="logout()" class="btn btn-danger w-100 mt-3 py-2"><i class="fas fa-sign-out-alt"></i> Çıkış Yap</button>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
    import { getAuth, signInAnonymously, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc, deleteDoc, query, where, getDocs, collection, orderBy, limit } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCildgfGrsyzGkOC6ClKHji_HunnJC3r2k",
      authDomain: "ec-farm-report-1d359.firebaseapp.com",
      projectId: "ec-farm-report-1d359",
      storageBucket: "ec-farm-report-1d359.firebasestorage.app",
      messagingSenderId: "751990003577",
      appId: "1:751990003577:web:e9036a63855828134e01a8"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const coops = ['1A', '1B', '2A', '2B', '3A', '3B', '4A', '4B', '5A', '5B', '6A', '6B', '7A', '7B', '8A', '8B', '9A', '9B'];
    const side15 = coops.slice(0,10);
    const side69 = coops.slice(10);
    const timeSlots = ['08:00', '09:00', '10:15', '13:00', '14:15'];

    window.login = async () => {
      try {
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        if (!usernameInput || !passwordInput) {
          alert('Kullanıcı adı veya şifre alanı bulunamadı!');
          return;
        }

        const username = usernameInput.value;
        const password = passwordInput.value;
        if (!username || !password) {
          alert('Kullanıcı adı ve şifre giriniz!');
          return;
        }

        const userCredential = await signInAnonymously(auth);
        const user = userCredential.user;
        const userDoc = await getDoc(doc(db, 'users', username));
        if (userDoc.exists() && userDoc.data().password === password) {
          localStorage.setItem('currentUser', username);
          await loadDashboard(userDoc.data().role, userDoc.data().coop, userDoc.data().side);
          document.getElementById('login-form').style.display = 'none';
          document.getElementById('dashboard').style.display = 'block';
          if (userDoc.data().role === 'admin') {
            document.getElementById('historyTab').style.display = 'block';
          }
        } else {
          alert('Geçersiz kullanıcı adı veya şifre!');
          auth.signOut();
        }
      } catch (error) {
        console.error('Giriş hatası:', error);
        alert('Giriş hatası: ' + error.message);
      }
    };

    window.logout = async () => {
      try {
        await signOut(auth);
        localStorage.removeItem('currentUser');
        document.getElementById('login-form').style.display = 'block';
        document.getElementById('dashboard').style.display = 'none';
        document.getElementById('change-credentials').style.display = 'none';
        alert('Çıkış yapıldı!');
      } catch (error) {
        alert('Çıkış hatası: ' + error.message);
      }
    };

    onAuthStateChanged(auth, async (user) => {
      if (user && localStorage.getItem('currentUser')) {
        document.getElementById('login-form').style.display = 'none';
        document.getElementById('dashboard').style.display = 'block';
        const username = localStorage.getItem('currentUser');
        const userDoc = await getDoc(doc(db, 'users', username));
        const role = userDoc.data().role;
        const coop = userDoc.data().coop;
        const side = userDoc.data().side;
        await loadDashboard(role, coop, side);
        setupChangeCredentials(role, username);
        if (role === 'admin') {
          document.getElementById('historyTab').style.display = 'block';
        }
      } else {
        document.getElementById('login-form').style.display = 'block';
        document.getElementById('dashboard').style.display = 'none';
        localStorage.removeItem('currentUser');
      }
    });

    async function loadDashboard(role, coop, side) {
      const today = new Date().toISOString().slice(0,10);
      let reportRef = doc(db, 'daily_reports', today);
      let report = (await getDoc(reportRef)).data() || {};
      if (!report.coops) report.coops = {};
      coops.forEach(c => {
        if (!report.coops[c]) report.coops[c] = {
          dead_chicken_left: 0,
          dead_chicken_right: 0,
          dead_rooster_left: 0,
          dead_rooster_right: 0,
          tray_right_front: 0,
          tray_right_back: 0,
          tray_left_front: 0,
          tray_left_back: 0,
          water_consumption: 0,
          temp_min: 0,
          temp_max: 0,
          floor_eggs: [0,0,0,0,0],
          timestamp: today
        };
      });

      const lastLoadedDate = localStorage.getItem('lastLoadedDate');
      if (!lastLoadedDate || lastLoadedDate !== today) {
        await setDoc(reportRef, report, { merge: true });
        localStorage.setItem('lastLoadedDate', today);
      }

      let html = '';
      if (role === 'keeper') {
        html = getKeeperForm(coop, report.coops[coop], today);
      } else if (role === 'duty') {
        const myCoops = side === '1-5' ? side15 : side69;
        html = myCoops.map(c => getDutyForm(c, report.coops[c], today)).join('');
      } else if (role === 'admin') {
        html = getAdminTable(report.coops) + '<button onclick="window.print()" class="btn btn-success w-100 mt-3 py-2"><i class="fas fa-print"></i> Yazdır</button>';
      }
      document.getElementById('dashboard-content').innerHTML = html;

      if (role !== 'admin') {
        setTimeout(() => {
          const buttons = document.querySelectorAll('.save-btn, .edit-btn');
          buttons.forEach(btn => {
            btn.onclick = async (e) => {
              try {
                e.preventDefault();
                const c = btn.dataset.coop;
                const isEdit = btn.classList.contains('edit-btn');
                const slotElement = document.getElementById(`slot-${c}`);
                const slot = timeSlots.indexOf(slotElement ? slotElement.value : '08:00');
                const addDeadCL = parseInt(document.getElementById(`add-dead-cl-${c}`)?.value || 0);
                const addDeadCR = parseInt(document.getElementById(`add-dead-cr-${c}`)?.value || 0);
                const addDeadRL = parseInt(document.getElementById(`add-dead-rl-${c}`)?.value || 0);
                const addDeadRR = parseInt(document.getElementById(`add-dead-rr-${c}`)?.value || 0);
                const currentTemp = parseFloat(document.getElementById(`temp-${c}`)?.value || NaN);
                const floor = parseInt(document.getElementById(`floor-${c}`)?.value || 0);

                let data = report.coops[c];
                data.dead_chicken_left += addDeadCL;
                data.dead_chicken_right += addDeadCR;
                data.dead_rooster_left += addDeadRL;
                data.dead_rooster_right += addDeadRR;
                data.floor_eggs[slot] = floor;
                if (!isNaN(currentTemp) && currentTemp > 0) {
                  if (currentTemp < data.temp_min || data.temp_min === 0) data.temp_min = currentTemp;
                  if (currentTemp > data.temp_max) data.temp_max = currentTemp;
                }

                if (role === 'keeper') {
                  data.tray_right_front = parseInt(document.getElementById(`tray-rf-${c}`)?.value || 0);
                  data.tray_right_back = parseInt(document.getElementById(`tray-rb-${c}`)?.value || 0);
                  data.tray_left_front = parseInt(document.getElementById(`tray-lf-${c}`)?.value || 0);
                  data.tray_left_back = parseInt(document.getElementById(`tray-lb-${c}`)?.value || 0);
                  const currentMeter = parseInt(document.getElementById(`meter-${c}`)?.value || 0);
                  const coopRef = doc(db, 'coops', c);
                  const coopDoc = await getDoc(coopRef);
                  const lastMeter = coopDoc.exists() ? coopDoc.data().last_meter : 0;
                  data.water_consumption = currentMeter - lastMeter;
                  await setDoc(coopRef, {last_meter: currentMeter}, { merge: true });
                }

                report.coops[c] = data;
                await setDoc(reportRef, report, { merge: true });
                alert('Veriler ' + (isEdit ? 'düzenlendi' : 'kaydedildi') + '!');
                await loadDashboard(role, coop, side);
              } catch (error) {
                console.error('Save/Edit error:', error);
                alert('İşlem hatası: ' + error.message);
              }
            };
          });
        }, 500);
      }
    }

    function setupChangeCredentials(role, currentUser) {
      const changeCredentialsDiv = document.getElementById('change-credentials');
      if (role === 'admin') {
        changeCredentialsDiv.style.display = 'block';
        document.getElementById('user-select').style.display = 'block';
        loadUserList();
      } else if (role === 'keeper') {
        const hasChanged = localStorage.getItem(`passwordChanged_${currentUser}`) === 'true';
        changeCredentialsDiv.style.display = hasChanged ? 'none' : 'block';
        document.getElementById('user-select').style.display = 'none';
      } else if (role === 'duty') {
        changeCredentialsDiv.style.display = 'block';
        document.getElementById('user-select').style.display = 'none';
      }
    }

    async function loadUserList() {
      const usersRef = collection(db, 'users');
      const querySnapshot = await getDocs(usersRef);
      const select = document.getElementById('target-user');
      select.innerHTML = '';
      querySnapshot.forEach((doc) => {
        const user = doc.id;
        const option = document.createElement('option');
        option.value = user;
        option.text = user;
        select.appendChild(option);
      });
    }

    window.changeCredentials = async () => {
      const currentUser = localStorage.getItem('currentUser');
      const userDoc = await getDoc(doc(db, 'users', currentUser));
      const role = userDoc.data().role;

      let targetUser;
      if (role === 'admin') {
        targetUser = document.getElementById('target-user').value;
      } else {
        targetUser = currentUser;
      }

      const newPassword = document.getElementById('new-password').value;
      if (!newPassword) {
        alert('Yeni şifre giriniz!');
        return;
      }

      try {
        const userRef = doc(db, 'users', targetUser);
        await updateDoc(userRef, { password: newPassword });

        if (role === 'keeper' && !localStorage.getItem(`passwordChanged_${currentUser}`)) {
          localStorage.setItem(`passwordChanged_${currentUser}`, 'true');
        }

        alert('Şifre başarıyla değiştirildi!');
        document.getElementById('new-password').value = '';
        setupChangeCredentials(role, currentUser);
      } catch (error) {
        alert('Hata oluştu: ' + error.message);
      }
    };

    function getKeeperForm(coop, data, today) {
      return `
        <div class="card p-4 mb-3">
          <h3>${coop} Kümes Verileri - Tarih: ${data.timestamp}</h3>
          <div class="mb-3">
            <label for="slot-${coop}" class="form-label">Giriş Saati:</label>
            <select id="slot-${coop}" class="form-control">
              ${timeSlots.map(t => `<option ${data.timestamp === today && data.floor_eggs[timeSlots.indexOf(t)] > 0 ? 'selected' : ''}>${t}</option>`).join('')}
            </select>
          </div>
          <div class="mb-3">
            <label for="add-dead-cl-${coop}" class="form-label">Ek Ölü Tavuk Sol:</label>
            <input type="number" id="add-dead-cl-${coop}" class="form-control" value="${data.dead_chicken_left}">
          </div>
          <div class="mb-3">
            <label for="add-dead-cr-${coop}" class="form-label">Ek Ölü Tavuk Sağ:</label>
            <input type="number" id="add-dead-cr-${coop}" class="form-control" value="${data.dead_chicken_right}">
          </div>
          <div class="mb-3">
            <label for="add-dead-rl-${coop}" class="form-label">Ek Ölü Horoz Sol:</label>
            <input type="number" id="add-dead-rl-${coop}" class="form-control" value="${data.dead_rooster_left}">
          </div>
          <div class="mb-3">
            <label for="add-dead-rr-${coop}" class="form-label">Ek Ölü Horoz Sağ:</label>
            <input type="number" id="add-dead-rr-${coop}" class="form-control" value="${data.dead_rooster_right}">
          </div>
          <div class="mb-3">
            <label for="temp-${coop}" class="form-label">Geçerli Sıcaklık (°C):</label>
            <input type="number" id="temp-${coop}" class="form-control" value="">
          </div>
          <div class="mb-3">
            <label for="floor-${coop}" class="form-label">Yer Yumurtası Sayısı:</label>
            <input type="number" id="floor-${coop}" class="form-control" value="${data.floor_eggs[timeSlots.indexOf(document.getElementById(`slot-${coop}`).value) || 0] || 0}">
          </div>
          <div class="mb-3">
            <label for="tray-rf-${coop}" class="form-label">Sağ Ön Dolu Tabak:</label>
            <input type="number" id="tray-rf-${coop}" class="form-control" value="${data.tray_right_front}">
          </div>
          <div class="mb-3">
            <label for="tray-rb-${coop}" class="form-label">Sağ Arka Dolu Tabak:</label>
            <input type="number" id="tray-rb-${coop}" class="form-control" value="${data.tray_right_back}">
          </div>
          <div class="mb-3">
            <label for="tray-lf-${coop}" class="form-label">Sol Ön Dolu Tabak:</label>
            <input type="number" id="tray-lf-${coop}" class="form-control" value="${data.tray_left_front}">
          </div>
          <div class="mb-3">
            <label for="tray-lb-${coop}" class="form-label">Sol Arka Dolu Tabak:</label>
            <input type="number" id="tray-lb-${coop}" class="form-control" value="${data.tray_left_back}">
          </div>
          <div class="mb-3">
            <label for="meter-${coop}" class="form-label">Su Sayaç Okuması:</label>
            <input type="number" id="meter-${coop}" class="form-control" value="">
          </div>
          <button class="btn btn-primary w-100 py-2 save-btn" data-coop="${coop}"><i class="fas fa-save"></i> Kaydet</button>
          <button class="btn btn-info w-100 py-2 mt-2 edit-btn" data-coop="${coop}"><i class="fas fa-edit"></i> Düzenle</button>
        </div>
      `;
    }

    function getDutyForm(coop, data, today) {
      return `
        <div class="card p-4 mb-3">
          <h3>${coop} Kümes Verileri (Nöbetçi) - Tarih: ${data.timestamp}</h3>
          <div class="mb-3">
            <label for="slot-${coop}" class="form-label">Giriş Saati:</label>
            <select id="slot-${coop}" class="form-control">
              ${timeSlots.map(t => `<option ${data.timestamp === today && data.floor_eggs[timeSlots.indexOf(t)] > 0 ? 'selected' : ''}>${t}</option>`).join('')}
            </select>
          </div>
          <div class="mb-3">
            <label for="add-dead-cl-${coop}" class="form-label">Ek Ölü Tavuk Sol:</label>
            <input type="number" id="add-dead-cl-${coop}" class="form-control" value="${data.dead_chicken_left}">
          </div>
          <div class="mb-3">
            <label for="add-dead-cr-${coop}" class="form-label">Ek Ölü Tavuk Sağ:</label>
            <input type="number" id="add-dead-cr-${coop}" class="form-control" value="${data.dead_chicken_right}">
          </div>
          <div class="mb-3">
            <label for="add-dead-rl-${coop}" class="form-label">Ek Ölü Horoz Sol:</label>
            <input type="number" id="add-dead-rl-${coop}" class="form-control" value="${data.dead_rooster_left}">
          </div>
          <div class="mb-3">
            <label for="add-dead-rr-${coop}" class="form-label">Ek Ölü Horoz Sağ:</label>
            <input type="number" id="add-dead-rr-${coop}" class="form-control" value="${data.dead_rooster_right}">
          </div>
          <div class="mb-3">
            <label for="temp-${coop}" class="form-label">Geçerli Sıcaklık (°C):</label>
            <input type="number" id="temp-${coop}" class="form-control" value="">
          </div>
          <div class="mb-3">
            <label for="floor-${coop}" class="form-label">Yer Yumurtası Sayısı:</label>
            <input type="number" id="floor-${coop}" class="form-control" value="${data.floor_eggs[timeSlots.indexOf(document.getElementById(`slot-${coop}`).value) || 0] || 0}">
          </div>
          <button class="btn btn-primary w-100 py-2 save-btn" data-coop="${coop}"><i class="fas fa-save"></i> Kaydet</button>
          <button class="btn btn-info w-100 py-2 mt-2 edit-btn" data-coop="${coop}"><i class="fas fa-edit"></i> Düzenle</button>
        </div>
      `;
    }

    function getAdminTable(coopsData) {
      let table = '<table class="table table-striped table-bordered"><thead><tr><th>Veri Türü</th>';
      coops.forEach(c => table += `<th>${c}</th>`);
      table += '</tr></thead><tbody>';
      table += getTableRow('Tarih', coopsData, 'timestamp');
      table += getTableRow('Ölü Tavuk Sol', coopsData, 'dead_chicken_left');
      table += getTableRow('Ölü Tavuk Sağ', coopsData, 'dead_chicken_right');
      table += getTableRow('Ölü Horoz Sol', coopsData, 'dead_rooster_left');
      table += getTableRow('Ölü Horoz Sağ', coopsData, 'dead_rooster_right');
      table += getTableRow('Sağ Ön Dolu Tabak', coopsData, 'tray_right_front');
      table += getTableRow('Sağ Arka Dolu Tabak', coopsData, 'tray_right_back');
      table += getTableRow('Sol Ön Dolu Tabak', coopsData, 'tray_left_front');
      table += getTableRow('Sol Arka Dolu Tabak', coopsData, 'tray_left_back');
      table += getTableRow('Su Tüketimi (Litre)', coopsData, 'water_consumption');
      table += getTableRow('Min Sıcaklık (°C)', coopsData, 'temp_min');
      table += getTableRow('Max Sıcaklık (°C)', coopsData, 'temp_max');
      table += getTableRow('Toplam Yer Yumurtası', coopsData, 'floor_eggs', true);
      table += '</tbody></table>';
      return table;
    }

    function getTableRow(label, data, key, sum=false) {
      let row = `<tr><td>${label}</td>`;
      coops.forEach(c => {
        let val = data[c][key];
        if (sum) val = val.reduce((a,b)=>a+b,0);
        if (key === 'temp_min' || key === 'temp_max') val += ' ℃';
        row += `<td>${val !== undefined ? val : 'N/A'}</td>`;
      });
      row += '</tr>';
      return row;
    }

    function switchTab(tab) {
      document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
      document.getElementById(`${tab}Tab`).classList.add('active');
      if (tab === 'history') {
        loadHistory();
      }
    }

    async function loadHistory() {
      const sevenDaysAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().slice(0,10);
      const reportsQuery = query(collection(db, 'daily_reports'), where('timestamp', '>=', sevenDaysAgo), orderBy('timestamp', 'desc'));
      const querySnapshot = await getDocs(reportsQuery);
      let html = '<h3>Geçmiş Raporlar</h3><ul class="list-group">';
      querySnapshot.forEach((doc) => {
        const data = doc.data();
        html += `<li class="list-group-item"><a href="#" onclick="showReport('${doc.id}')">${data.timestamp}</a></li>`;
      });
      html += '</ul>';
      document.getElementById('history-content').innerHTML = html;
    }

    async function showReport(date) {
      const reportRef = doc(db, 'daily_reports', date);
      const report = (await getDoc(reportRef)).data();
      if (report) {
        document.getElementById('history-content').innerHTML = getAdminTable(report.coops) + '<button onclick="switchTab(\'history\')" class="btn btn-secondary w-100 mt-3 py-2"><i class="fas fa-arrow-left"></i> Geri</button>';
      }
    }
  </script>
</body>
</html>
